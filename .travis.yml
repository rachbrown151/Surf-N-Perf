language: node_js
node_js:
  - "0.10"
env:
  global:
    - GH_REF: "github.com/rachbrown151/Surf-N-Perf"
    - secure: "gfPoLSAj3+kYluRzuwPtrik93SXL1Pefq4PR9odncqkgd5hA8vpMP9gqwIyyM1LubBctbbFxMO8Zt8jFGGpZCqMp57LZSkWj5nayk0SUn3YtBoXTsLXAy+WLEUr8qXRtxFhXCJIwhYuhMucZAowoaAaZmnLcRcRJj1MSCQA5Yzw="
branches:
  only:
    - master
    - documentation
before_install: npm install -g grunt-cli
install:
  - npm install
after_success:
  - git remote set-url origin "github.com/rachbrown151/Surf-N-Perf.git"
  - git config --global user.email "rabrown@seas.upenn.edu"
  - git config --global user.name "Rachel Brown"
  - grunt jsdoc
  - git add -A
  - git status
  - git stash
  - git checkout -b gh-pages
  - ls
  - mkdir docs
  - "cp -r . docs/*
  - ls
  - mkdir demo
  - mv docs/demo.html demo/demo.html
  - "rm -r *"
  - ls
  - git stash apply
  - rm index.html
  - mv SurfNPerf.html index.html
  - ls
  - git checkout gh-pages
  - git checkout master
  - git merge "https://${GH_TOKEN}:@${GH_REF}" master gh-pages
  - git add -A
  - git commit -m "Automated documentation update"
  - git push "https://${GH_TOKEN}:@${GH_REF}" master:gh-pages --force
  - git checkout master
  - git branch -d gh-pages
